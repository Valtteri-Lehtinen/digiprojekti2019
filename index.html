<!DOCTYPE html>
<html lang="">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Digiprojekti</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="./digiproj4.1_files/tyyli.css" media="screen">
</head>

<body>

    <div class="login-wrap">
        <div class="login-html">


            <form id="jebe">
                <div id="pepe">HHMoodle Kysely<br><br></div><br>

                <button onclick="laheta()" id="vastaus" name="submit" type="submit">Lähetä</button>

            </form>


        </div>
    </div>
    <script src="./digiproj4.1_files/jquery.min.js.lataus"></script>
    <script type="text/javascript" async="" src="./digiproj4.1_files/analytics.js.lataus"></script>
    <script src="./digiproj4.1_files/jquery-3.3.1.min.js.lataus"></script>

    <script>
        var tunnukset = [];
        var items = [];
        $.getJSON("https://moodleinquiry.herokuapp.com/open/questions", function(data) {



            $.each(data, function(key, d) {
                items.push("<br>" + d.questionText + "<br>");

                if (d.questionType.type == "Radio") {
                    for (i = 0; i < d.responseOptions.length; i++) {
                        items.push("<input type=radio" + " id= " + d.id + " name=" + d.id + " value=" + d.responseOptions[i] + ">" + d.responseOptions[i] + "<br>");
                    }
                };

                if (d.questionType.type == "Select") {
                    items.push("<select name=wwww id=" + d.id + ">");
                    for (i = 0; i < d.responseOptions.length; i++) {
                        items.push("<option" + " value=" + d.responseOptions[i] + ">" + d.responseOptions[i] + "<br>")

                    }
                    items.push("</select><br>");
                };

                if (d.questionType.type == "Open Text") {
                    items.push("<input type=text" + " id= " + d.id + " name=" + d.id + "> <br>");

                }
            });

            $("#pepe").append(items.join(""));
        });

        function laheta() {
            for (i = 0; i < tunnukset.length; i++) {
                vastaus = document.getElementById(tunnukset[i]).value;

                alert('{"responseOptions" :"' + vastaus + '" ,"questionText" : {"id" : ' + tunnukset[i] + '}}');
            }

            //var jsonData = {"responseOptions" : vastaus ,"questionText" : {"id" : tunnukset[i]}
        }; //

        var myJSON = JSON.stringify(jsonData);
        alert(myJSON);
        $.ajax({
            url: "https://moodleinquiry.herokuapp.com/open/answers",
            type: 'POST',
            dataType: 'application/json',
            contentType: 'application/json',
            data: myJSON,
            success: function() {
                alert('POST completed. Data:' + myJSON)
            },
            error: function(xhr, status, error) {
                console.log(xhr.statusText);
                console.log(status);
                console.log(error);
            },

        });

    </script>

</body>

</html>
